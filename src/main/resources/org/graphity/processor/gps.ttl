@base           <http://graphity.org/gps> .

# @prefix :	<#> .
@prefix gc:     <http://graphity.org/gc#> .
@prefix rdf:	<http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs:	<http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd:	<http://www.w3.org/2001/XMLSchema#> .
@prefix owl:	<http://www.w3.org/2002/07/owl#> .
@prefix ldt:    <http://www.w3.org/ns/ldt#> .
@prefix ldtc:   <http://www.w3.org/ns/ldt/core#> .
@prefix ldtdh:  <http://www.w3.org/ns/ldt/document-hierarchy#> .
@prefix dc:	<http://purl.org/dc/elements/1.1/> .
@prefix dct:	<http://purl.org/dc/terms/> .
@prefix sp:	<http://spinrdf.org/sp#> .
@prefix spin:	<http://spinrdf.org/spin#> .
@prefix spl:    <http://spinrdf.org/spl#> .
@prefix foaf:	<http://xmlns.com/foaf/0.1/> .

<#> a owl:Ontology ;
    owl:imports ldtdh:, ldtc:, sp:, spin:, foaf: ;
    owl:versionInfo "1.1.4" ;
    rdfs:label "Graphity Processor sitemap" ;
    rdfs:comment "Ontology of Graphity Client domain resource templates" .

ldtc:SPARQLEndpoint gc:supportedMode gc:ReadMode, gc:ListMode, gc:TableMode, gc:MapMode .

# TEMPLATES

<#Document> a rdfs:Class, owl:Class, ldt:Template ;
    rdfs:subClassOf ldtc:Document ;
    gc:supportedMode gc:ReadMode, gc:EditMode ;
    gc:defaultMode gc:ReadMode ;
    rdfs:label "Document" ;
    rdfs:isDefinedBy <#> .

<#Container> a rdfs:Class, owl:Class, ldt:Template ;
    rdfs:subClassOf ldtdh:Container ;
    ldt:param [ a ldt:Argument ;
        spl:predicate ldtdh:limit ;
        spl:valueType xsd:long ;
        spl:defaultValue 20 ;
        spl:optional true ;
        ldt:tunnel true
    ] ;
    gc:supportedMode gc:ReadMode, gc:ListMode, gc:TableMode ;
    gc:defaultMode gc:ListMode ;
    rdfs:label "Container" ;
    rdfs:isDefinedBy <#> .

<#SPARQLEndpoint> a rdfs:Class, owl:Class, ldt:Template ;
    rdfs:subClassOf ldtc:SPARQLEndpoint ;
    rdfs:label "SPARQL endpoint" ;
    rdfs:isDefinedBy <#> .

<#GraphStore> a rdfs:Class, owl:Class, ldt:Template ;
    rdfs:subClassOf ldtc:GraphStore ;
    rdfs:label "Graph Store" ;
    rdfs:isDefinedBy <#> .

# CLASSES

<#Template> a rdfs:Class, owl:Class ;
    rdfs:subClassOf ldt:Template ,
        [ a owl:Restriction ;
            owl:onProperty foaf:isPrimaryTopicOf ;
            owl:allValuesFrom ldtc:Document
	] ;
    rdfs:label "Template" ;
    rdfs:isDefinedBy <#> .

<#Query> a rdfs:Class, owl:Class ;
    rdfs:subClassOf ldt:Query ,
        [ a owl:Restriction ;
            owl:onProperty foaf:isPrimaryTopicOf ;
            owl:allValuesFrom ldtc:Document
	] ;
    rdfs:label "Query" ;
    rdfs:isDefinedBy <#> .

<#Constraint> a rdfs:Class, owl:Class ;
    rdfs:subClassOf ldt:Constraint ,
        [ a owl:Restriction ;
            owl:onProperty foaf:isPrimaryTopicOf ;
            owl:allValuesFrom ldtc:Document
	] ;
    rdfs:label "Constraint" ;
    rdfs:isDefinedBy <#> .

<#CommandTemplate> a rdfs:Class, owl:Class ;
    rdfs:subClassOf ldt:CommandTemplate ,
        [ a owl:Restriction ;
            owl:onProperty foaf:isPrimaryTopicOf ;
            owl:allValuesFrom ldtc:Document
	] ;
    rdfs:label "Command template" ;
    rdfs:isDefinedBy <#> .

# QUERIES

<#DescribeLabelResources> a sp:Describe, sp:Query ;
      sp:text """PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX foaf: <http://xmlns.com/foaf/0.1/>
PREFIX sioc: <http://rdfs.org/sioc/ns#>
PREFIX dc: <http://purl.org/dc/elements/1.1/>
PREFIX dct: <http://purl.org/dc/terms/>

DESCRIBE ?this ?resource ?thing ?doc WHERE {
    {
        SELECT DISTINCT ?resource ?thing ?doc
        WHERE {
            ?resource rdfs:label|dct:title ?label .
            FILTER isURI(?resource) .
            OPTIONAL {
                ?resource foaf:primaryTopic ?thing # ?resource is a document
            }
            OPTIONAL {
                ?resource foaf:isPrimaryTopicOf ?doc # ?resource is a thing
            }
        }
    } .
}""" ;
    rdfs:label "Describe labelled resources" ;
    rdfs:isDefinedBy <#> .